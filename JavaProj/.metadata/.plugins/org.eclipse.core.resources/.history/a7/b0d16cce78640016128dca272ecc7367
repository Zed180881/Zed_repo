package ua.service.implementation.validators;

import org.springframework.validation.Errors;
import org.springframework.validation.ValidationUtils;
import org.springframework.validation.Validator;

import ua.entity.User;
import ua.service.UserService;

public class UserValidator implements Validator {

    private final UserService userService;

    public UserValidator(UserService userService) {
	this.userService = userService;
    }

    @Override
    public boolean supports(Class<?> arg0) {
	return User.class.isAssignableFrom(arg0);
    }

    @Override
    public void validate(Object object, Errors errors) {
	User user = (User) object;
	ValidationUtils.rejectIfEmptyOrWhitespace(errors, "fullName", "",
		"User name cann't be empty");
	ValidationUtils.rejectIfEmptyOrWhitespace(errors, "login", "",
		"Login cann't be empty");
	ValidationUtils.rejectIfEmptyOrWhitespace(errors, "password", "",
		"Password cann't be empty");
	ValidationUtils.rejectIfEmptyOrWhitespace(errors, "mail", "",
		"Mail cann't be empty");
	ValidationUtils.rejectIfEmptyOrWhitespace(errors, "phone", "",
		"Phone cann't be empty");
	ValidationUtils.rejectIfEmptyOrWhitespace(errors, "address", "",
		"Address cann't be empty");
	
	
	
	if (userService.findByUserFullName(user.getFullName()) != null)
	    errors.rejectValue("fullName", "",
		    "User with this name already exists");
    }

}
